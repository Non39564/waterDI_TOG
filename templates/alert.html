{% extends 'layout.html' %}
{% block title %}Alert{% endblock %}
{% block head %}
<!-- DataTable script -->
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.2/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/datetime/1.1.2/js/dataTables.dateTime.min.js"></script>
<!-- DataTable css -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/datetime/1.1.2/css/dataTables.dateTime.min.css" />
<!-- Include Date Range Picker -->
<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
<!-- script pagination -->
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.12.1/dataRender/datetime.js"></script>
{% endblock %}
{% block content %}
<div class="card mt-3">
  <div class="card-header  bg-danger bg-gradient text-white">
    <div class="row justify-content-lg-end">
      <div class="col-lg-5">
        <h5>Alert status</h5>
      </div>
      <div class="col-lg-7 d-flex justify-content-lg-end ">
        <!-- date range filter -->
        <!-- <table cellspacing="5" cellpadding="5">
          <tbody>
            <tr >
              <td><h5>Choose Date :</h5></td>
              <td><input type="text" class="form-control" id="min" name="min"></td>
              <td><h5>To</h5></td>
              <td><input type="text" class="form-control" id="max" name="max"></td>
            </tr>
          </tbody>
        </table> -->
      <!-- End date range filter -->
    </div>
    </div>
  </div>
    <div class="card-body">
      <table class="display table align-middle mb-0 bg-white" id="alert">
        <thead class="bg-light">
          <tr>
            <th>Station</th>
            <th>Phase</th>
            <th>Machine</th>
            <th>Detail</th>
            <th>Date</th>
            <th>Time</th>
          </tr>
        </thead>
      </table>
      
    </div>
</div>
{% endblock %}
{% block script %}
<script>
  $(document).ready(function () {
    var Alert_table = $("#alert").DataTable({
      processing: true,
      serverSide: true,
      serverMethod: "post",
      ajax: {
        url: "/data_alert",
      },
      lengthMenu: [
        [10, 20, 30, 40, 50, 100],
        [10, 20, 30, 40, 50, 100],
      ],
      searching: true,
      sort: false,
      serverSide: true,
      createdRow: function (row, data, index) {
        if (data.Detail === "Monitor") {
          $("td", row).eq(3).addClass("text-yello");
        } else {
          $("td", row).eq(3).addClass("text-warning");
        }
      },
      columns: [
        { data: "Station" },
        { data: "Phase" },
        { data: "Site" },
        { data: "Detail" },   
        { data: "Date" },
        { data: "Time" },
      ],
      columnDefs: [
        {
          targets: 4,
          render: function (data, type, row, meta) {
            return moment.utc(data).local().format("YYYY-MM-DD");
          },
        },
      ],
      dom: 'Blfrtip',
      buttons: [
        {
          extend: 'excel',
          text: '<i class="fa fa-file-excel me-2"></i><span>generate excel</span>',
          className: 'mb-3 btn btn-success me-1',
        },
        {
            extend: 'pdf',
            text: '<i class="fa fa-file-pdf me-2"></i><span>generate PDF</span>',
            className: 'mb-3 btn btn-danger me-1',
        }
      ],
    });
  });
</script>
{% endblock %}